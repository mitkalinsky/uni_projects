<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>BoardGame Hub — Оформление заказа</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link
    rel="stylesheet"
    href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
  >
  <style>
    :root {
      --bg-main: #f5f5f7;
      --bg-card: #ffffff;
      --accent: #111827;
      --accent-blue: #2563eb;
      --text-main: #111827;
      --text-muted: #6b7280;
      --radius-lg: 18px;
      --shadow-soft: 0 18px 45px rgba(15, 23, 42, 0.08);
    }
    * { box-sizing: border-box; }
    body {
      padding-top: 72px;
      background-color: var(--bg-main);
      color: var(--text-main);
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "SF Pro Text",
        "Segoe UI", sans-serif;
      letter-spacing: 0.01em;
    }
    .navbar {
      background: rgba(15, 23, 42, 0.9) !important;
      backdrop-filter: blur(14px);
      border-bottom: 1px solid rgba(148, 163, 184, 0.25);
    }
    .navbar-brand {
      font-weight: 600;
      letter-spacing: 0.08em;
      text-transform: uppercase;
      font-size: 0.9rem;
    }
    .nav-link {
      font-size: 0.9rem;
      text-transform: uppercase;
      letter-spacing: 0.12em;
      color: rgba(229, 231, 235, 0.8) !important;
    }
    .nav-link.active {
      color: #f9fafb !important;
      position: relative;
    }
    .nav-link.active::after {
      content: "";
      position: absolute;
      inset-inline: 18%;
      bottom: -4px;
      height: 2px;
      border-radius: 999px;
      background: linear-gradient(90deg, #38bdf8, #6366f1, #ec4899);
    }
    main {
      max-width: 960px;
    }
    .page-kicker {
      text-transform: uppercase;
      letter-spacing: 0.16em;
      font-size: 0.78rem;
      color: var(--text-muted);
    }
    .page-title {
      font-size: clamp(2rem, 3vw, 2.4rem);
      letter-spacing: -0.05em;
      margin-bottom: 0.9rem;
    }
    .page-subtitle {
      max-width: 540px;
      font-size: 0.96rem;
      color: var(--text-muted);
    }
    .order-shell {
      background: var(--bg-card);
      border-radius: 24px;
      border: 1px solid rgba(209, 213, 219, 0.9);
      box-shadow: var(--shadow-soft);
      padding: 1.7rem 1.5rem 1.5rem;
    }
    .order-table-header,
    .order-table-row {
      display: grid;
      grid-template-columns: 1.5fr 0.7fr 0.6fr 0.7fr;
      column-gap: 0.75rem;
      font-size: 0.88rem;
      align-items: center;
    }
    .order-table-header {
      font-size: 0.8rem;
      text-transform: uppercase;
      letter-spacing: 0.14em;
      color: var(--text-muted);
      border-bottom: 1px solid rgba(209, 213, 219, 0.9);
      padding-bottom: 0.35rem;
      margin-bottom: 0.35rem;
    }
    .order-table-row {
      padding: 0.4rem 0;
      border-bottom: 1px solid rgba(243, 244, 246, 1);
    }
    .order-table-row:last-child {
      border-bottom: none;
    }
    .order-summary {
      font-size: 0.9rem;
      padding-top: 0.6rem;
      border-top: 1px solid rgba(209, 213, 219, 0.9);
      margin-top: 0.4rem;
    }
    .form-label {
      font-size: 0.86rem;
      color: var(--text-main);
      margin-bottom: 0.25rem;
    }
    .form-control, .form-select {
      border-radius: 999px;
      border-color: rgba(209, 213, 219, 0.9);
      font-size: 0.9rem;
      padding-inline: 1rem;
    }
    textarea.form-control {
      border-radius: 1rem;
      min-height: 90px;
    }
    .form-control:focus, .form-select:focus {
      border-color: var(--accent-blue);
      box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.15);
    }
    .small-hint {
      font-size: 0.76rem;
      color: var(--text-muted);
    }
    fieldset {
      border: none;
      padding: 0;
      margin: 0 0 0.75rem;
    }
    legend {
      font-size: 0.82rem;
      font-weight: 600;
      margin-bottom: 0.4rem;
    }
    .form-check-label {
      font-size: 0.85rem;
    }
    .btn-primary-min {
      border-radius: 999px;
      font-size: 0.83rem;
      text-transform: uppercase;
      letter-spacing: 0.16em;
      padding: 0.65rem 1.7rem;
      border: none;
      background: #111827;
      color: #f9fafb;
    }
    .btn-primary-min:hover {
      background: #000000;
    }
    .btn-ghost-link {
      font-size: 0.8rem;
      text-transform: uppercase;
      letter-spacing: 0.14em;
      color: var(--text-muted);
      text-decoration: none;
    }
    .btn-ghost-link:hover { color: var(--accent-blue); }
    footer.site-footer {
      border-top: 1px solid rgba(148, 163, 184, 0.35);
      padding: 1.5rem 0 1.25rem;
      font-size: 0.78rem;
      color: var(--text-muted);
      background-color: #f9fafb;
      margin-top: 3rem;
    }
    footer .footer-right {
      display: flex;
      gap: 1.25rem;
      flex-wrap: wrap;
      justify-content: flex-end;
    }
    footer a {
      color: inherit;
      text-decoration: none;
    }
    footer a:hover { text-decoration: underline; }
    @media (max-width: 640px) {
      .order-table-header {
        display: none;
      }
      .order-table-row {
        grid-template-columns: 1.4fr 0.8fr;
        grid-template-rows: auto auto;
        row-gap: 0.2rem;
      }
    }
  </style>
</head>
<body id="top">
<nav class="navbar navbar-expand-lg navbar-dark fixed-top">
  <div class="container">
    <a class="navbar-brand" href="index.html">BoardGame Hub</a>
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse"
            data-bs-target="#mainNav" aria-controls="mainNav"
            aria-expanded="false" aria-label="Переключить навигацию">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="mainNav">
      <ul class="navbar-nav ms-auto mb-2 mb-lg-0 align-items-lg-center gap-lg-2">
        <li class="nav-item">
          <a class="nav-link" href="index.html">Главная</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="catalog.html">Каталог</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="about.html">О нас</a>
        </li>
        <li class="nav-item me-lg-2">
          <a class="nav-link active" aria-current="page" href="order.html">Заказ</a>
        </li>
      </ul>
    </div>
  </div>
</nav>

<main class="container my-4">
  <header class="mb-4">
    <p class="page-kicker mb-2">Заказ</p>
    <h1 class="page-title">Проверьте корзину и подтвердите заказ</h1>
    <p class="page-subtitle">
      Здесь отображается содержимое корзины, сохранённое на странице каталога. При необходимости вернитесь назад и измените состав, затем заполните форму и отправьте заказ.
    </p>
  </header>

  <!-- Внутренняя навигация -->
  <nav class="mb-3">
    <span class="page-kicker me-2" style="font-size:0.7rem;">Навигация:</span>
    <a class="btn-ghost-link me-2" href="#order-items">Раздел 1</a>
    <a class="btn-ghost-link me-2" href="#order-form">Раздел 2</a>
    <a class="btn-ghost-link" href="#top">К началу</a>
  </nav>

  <div class="order-shell mb-4" id="order-items">
    <h2 class="page-kicker mb-3" style="font-size:0.8rem;">Состав корзины</h2>
    <div id="cart-empty" class="small-hint mb-2" style="display:none;">
      Корзина пуста. Перейдите в каталог и добавьте игры.
    </div>

    <div id="cart-table">
      <div class="order-table-header">
        <div>Игра</div>
        <div>Цена</div>
        <div>Кол-во</div>
        <div>Сумма</div>
      </div>
      <div id="order-rows"></div>
      <div class="order-summary">
        <div class="d-flex justify-content-between">
          <span>Всего позиций:</span>
          <span id="order-items-count">0</span>
        </div>
        <div class="d-flex justify-content-between">
          <span>Итоговая сумма:</span>
          <span id="order-total">0 ₽</span>
        </div>
      </div>
    </div>

    <p class="small-hint mt-2 mb-0">
      Количество можно отредактировать на странице каталога в корзине. Здесь корзина отображается только для проверки перед отправкой.
    </p>
  </div>

  <div class="order-shell" id="order-form">
    <form
      class="row g-3"
      action="https://httpbin.org/post"
      method="post"
    >
      <!-- Сериализованная корзина -->
      <input type="hidden" name="cart_json" id="cart-json">

      <section class="col-12">
        <h2 class="page-kicker mb-3" style="font-size:0.8rem;">Данные покупателя</h2>

        <div class="mb-2">
          <label for="customerName" class="form-label">Имя и фамилия *</label>
          <input
            type="text"
            class="form-control"
            id="customerName"
            name="customer_name"
            placeholder="Например, Иван Петров"
            required
          >
        </div>

        <div class="mb-2">
          <label for="customerEmail" class="form-label">Электронная почта *</label>
          <input
            type="email"
            class="form-control"
            id="customerEmail"
            name="customer_email"
            placeholder="example@mail.ru"
            required
          >
        </div>

        <div class="mb-2">
          <label for="customerPhone" class="form-label">Телефон *</label>
          <input
            type="text"
            class="form-control"
            id="customerPhone"
            name="customer_phone"
            placeholder="+7 900 000-00-00"
            required
          >
        </div>

        <p class="small-hint mb-0">
          Контакты используются только для связи по текущему заказу и не передаются третьим лицам.
        </p>
      </section>

      <section class="col-12 mt-3">
        <h2 class="page-kicker mb-3" style="font-size:0.8rem;">Доставка</h2>

        <fieldset class="mb-2">
          <legend>Способ доставки *</legend>
          <div class="form-check">
            <input
              class="form-check-input"
              type="radio"
              name="delivery_type"
              id="deliveryPickup"
              value="pickup"
              required
            >
            <label class="form-check-label" for="deliveryPickup">
              Самовывоз из магазина
            </label>
          </div>
          <div class="form-check">
            <input
              class="form-check-input"
              type="radio"
              name="delivery_type"
              id="deliveryCourier"
              value="courier"
            >
            <label class="form-check-label" for="deliveryCourier">
              Курьер по городу
            </label>
          </div>
          <div class="form-check">
            <input
              class="form-check-input"
              type="radio"
              name="delivery_type"
              id="deliveryPost"
              value="post"
            >
            <label class="form-check-label" for="deliveryPost">
              Доставка почтой
            </label>
          </div>
        </fieldset>

        <div class="mb-2">
          <label for="deliveryAddress" class="form-label">
            Адрес доставки (если выбрана доставка)
          </label>
          <input
            type="text"
            class="form-control"
            id="deliveryAddress"
            name="delivery_address"
            placeholder="Город, улица, дом, квартира"
          >
        </div>

        <div class="mb-2">
          <label for="customerComment" class="form-label">Комментарий к заказу</label>
          <textarea
            class="form-control"
            id="customerComment"
            name="customer_comment"
            rows="3"
            placeholder="Дополнительные пожелания, удобное время звонка и т.п."
          ></textarea>
        </div>
      </section>

      <div class="col-12 d-flex justify-content-between align-items-center mt-3">
        <a href="catalog.html" class="btn-ghost-link">Вернуться в каталог</a>
        <button type="submit" class="btn-primary-min">
          Подтвердить заказ
        </button>
      </div>
    </form>
  </div>
</main>

<footer class="site-footer">
  <div class="container d-flex flex-column flex-md-row justify-content-between align-items-start gap-2">
    <div>
      <div class="page-kicker mb-1">BoardGame Hub</div>
      <div>Минималистичный магазин настольных игр, 2025.</div>
    </div>
    <div class="footer-right">
      <span>email: orders@boardgame-hub.example</span>
      <a href="catalog.html">Вернуться в каталог</a>
      <a href="about.html">О магазине</a>
    </div>
  </div>
</footer>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
<script>
  // Те же товары, что и в каталоге — чтобы пересчитать сумму
  const products = [
    { id: 'catan', title: 'Колонизаторы', price: 3200 },
    { id: 'carcassonne', title: 'Каркассон', price: 2900 },
    { id: 'imaginarium', title: 'Имаджинариум', price: 2500 },
    { id: 'munchkin', title: 'Манчкин', price: 2100 },
    { id: 'alias', title: 'Alias', price: 1800 },
    { id: 'codenames', title: 'Кодовые имена', price: 2400 },
    { id: 'ticket-to-ride', title: 'Ticket to Ride', price: 3900 },
    { id: 'dixit', title: 'Диксит', price: 3100 }
  ];
  const productMap = Object.fromEntries(products.map(p => [p.id, p]));
  const CART_KEY = 'boardgame_cart';

  function loadCart() {
    let cart = {};
    try {
      const raw = localStorage.getItem(CART_KEY);
      if (raw) cart = JSON.parse(raw);
    } catch (e) {
      cart = {};
    }
    return cart;
  }

  function renderOrder() {
    const cart = loadCart();
    const rowsEl = document.getElementById('order-rows');
    const totalEl = document.getElementById('order-total');
    const countEl = document.getElementById('order-items-count');
    const hiddenCart = document.getElementById('cart-json');
    const emptyEl = document.getElementById('cart-empty');
    const tableEl = document.getElementById('cart-table');

    const entries = Object.entries(cart);
    if (entries.length === 0) {
      emptyEl.style.display = 'block';
      tableEl.style.display = 'none';
      if (hiddenCart) hiddenCart.value = '{}';
      return;
    }

    emptyEl.style.display = 'none';
    tableEl.style.display = 'block';

    let total = 0;
    let positions = 0;
    rowsEl.innerHTML = '';

    entries.forEach(([id, qty]) => {
      const p = productMap[id];
      if (!p || qty <= 0) return;
      positions += 1;
      const rowTotal = p.price * qty;
      total += rowTotal;

      const row = document.createElement('div');
      row.className = 'order-table-row';
      row.innerHTML = `
        <div>${p.title}</div>
        <div>${p.price} ₽</div>
        <div>${qty}</div>
        <div>${rowTotal} ₽</div>
      `;
      rowsEl.appendChild(row);
    });

    if (countEl) countEl.textContent = positions.toString();
    if (totalEl) totalEl.textContent = total + ' ₽';
    if (hiddenCart) hiddenCart.value = JSON.stringify(cart);
  }

  renderOrder();
</script>
</body>
</html>
